# 5 순환 참조
순환 참조
- 두 개 이상의 객체나 컴포넌트가 서로를 참조함 -> 의존 관계에 사이클 발생 -> 대표적인 안티패턴 중 하나
~~~
JPA의 양방향 매핑 설명 시 Team-Member 사례를 이용.
-> JPA를 사용 시 순환 참조를 거리낌 없이 만들고 함.
~~~

양방향 매핑은 수많은 순환 참조 사례 중 하나

~~~
TeamService, MemberSerivce를 확인하면 TeamService는 MemberService를 참조하고,
MemberService는 또 TeamService를 참조
-> 사실상 하나의 컴포넌트 => 책임의 구분x, SOLID하지도 않다.
~~~
## 순환 참조의 문제점
### 1. 무한 루프
~~~
CircularEx1을 참고
Team -> Member
Member -> Team
계속 무한 루프 -> 직렬화 불가능
~~~

무한루프는 개발자가 메서드 호출 과정을 신경 쓴다고 해결할 수 있는 문제x

~> 소프트웨어는 복잡계라서 언제, 어디서, 어떤 식으로 작용이 발생할 지 모름.

=>순환 참조를 만들지 않으면 된다.

### 2. 시스템 복잡도
시스템 복잡도를 높인다. -> 의존성 전이 확장과도 비슷하나 좀 더 실무적인 문제
~~~
Member에 소속된 팀의 전체 월급이 얼마인지 알 수있는 메서드를 추가 -> 말이 안됨.
- 팀원이 어떻게 팀 내 전체 구성원의 월급을 알 수 있나
~~~
=> 의미상 말이 안되는 코드는 컴파일 타임에 아예 생성x
- 시스템 복잡도가 증가 -> 코드의 복잡도 증가뿐만 아닌, 개발자가 겪는 논리적 혼란도 포함

Team - Member 간의 순환 참조를 어떻게 제거 할까?
1. Member의 식별자를 대신 배치 -> 양방향 참조를 제거
2. 상위 객체에 있던 하위 객체에 대한 참조를 제거 -> 순환 참조를 제거

~~~
'접근 경로가 많다.' -> 의존 관계가 복잡하게 얽혀있다.
=> 가능 한 도메인 모델들에 단일 진입점을 만들어서 필요한 객체가 있을 때 단방향으로 접근하도록 만든다.
~~~